第十七章 隐藏的授权

学完貔貅盘识别技术后，我感觉自己在Web3安全方面已经有了不错的基础。这一周里，我在各种群里看到那些明显的骗局时，都能第一时间识破，甚至还提醒了几个同学避免上当。

这种「专家」的感觉让我有些飘飘然。

直到那个周六的下午。

我正在宿舍里整理这周的学习笔记，顺便打开MetaMask查看钱包余额。ETH还是那么多，USDC也没有变化，一切都很正常。

但当我往下滑动查看代币列表时，发现了几个陌生的代币：

「SafeMoon2.0 - 100,000 个」

「LuckyDoge - 50,000 个」

「BabyShiba - 999,999 个」

我皱起眉头。这些代币我完全没印象，什么时候出现在我钱包里的？

我试着回想最近的操作，但确实没有购买过这些代币。会不会是空投？但艾丽丝说过，主动空投到钱包里的代币99%都是陷阱。

我点击查看这些代币的价值，显示都是「$0.00」，看起来毫无价值。

正当我疑惑时，小李从外面回来了。

「陈羽，你在研究什么？」他凑过来看我的屏幕。

「我钱包里莫名其妙多了些代币，不知道怎么来的。」我把手机给他看。

小李看了看：「哎，我钱包里也有这些！我还以为是免费空投呢。不过既然没价值，就不管了吧。」

听到小李也有同样的情况，我更加警觉了。这绝对不是巧合。

我立刻给艾丽丝发了消息：「艾丽丝，我钱包里出现了一些不认识的代币，我没有购买过。这是什么情况？」

她很快回复：「又遇到问题了？明天下午两点，图书馆。把具体情况准备好。」

虽然语气依然冷淡，但我注意到她说的是「明天」，而不是推迟到更晚。说明她还是很重视这个问题的。

第二天下午，我提前到了图书馆，把钱包的截图和最近的交易记录都整理好了。

艾丽丝准时出现，坐下后直接问：「说说具体情况。」

我把发现的异常代币给她看，并解释了我的疑惑。

她看了看截图，点了点头：「典型的dust attack。」

「Dust attack？」

「就是向大量钱包地址发送微量代币，用来追踪用户行为或者诱导用户交互。」艾丽丝打开她的笔记本，「不过这些代币本身不是重点，重点是你可能在不知情的情况下授权了一些恶意合约。」

「什么意思？我最近很小心，没有连接过可疑网站啊。」我有些不解。

「授权不只在你主动操作时发生。」艾丽丝调出一个网站，「有些恶意合约会在你进行其他操作时，偷偷增加额外的授权。我们来检查一下你钱包的所有授权。」

她打开了revoke.cash网站：「把你的钱包地址输入这里。」

我照做了，几秒钟后，页面显示出了一长串的授权列表。我数了数，居然有十几个！

「这么多？」我震惊地说，「我记得之前只有几个啊。」

艾丽丝开始逐个查看这些授权：「你看这个，授权给0x7a...这个地址，时间是三天前。你还记得那天做了什么操作吗？」

我仔细回想：「三天前...我好像在Uniswap上swap了一些代币。」

「就是那时候。」艾丽丝指着屏幕，「你以为只是在做swap，但实际上可能同时授权了其他合约。而且你看这个授权额度，是unlimited，意味着这个合约可以无限制地转走你的USDC。」

我的脸瞬间发白：「那我的USDC会不会已经...」

「暂时还安全，因为这些代币数量不大，骗子可能在等更多用户上钩后再统一行动。」艾丽丝的语气依然冷静，「但你需要立刻撤销这些可疑授权。」

她开始教我如何使用revoke.cash：「这个工具可以查看和撤销所有授权。你看，每个授权都显示了合约地址、授权时间、授权金额等信息。」

我跟着她的指导，开始仔细查看每个授权。确实发现了几个我完全不记得的授权，授权时间都是最近一周内。

「这些我确实不记得授权过。」我指着屏幕说。

「这就是问题所在。」艾丽丝的表情变得严肃，「很多人以为自己很小心，但实际上在不知不觉中就被套路了。」

她开始系统地教我如何识别和管理授权：

「首先，你要定期检查授权，建议至少每月一次。」

「其次，看到不认识的授权要立刻撤销，不要心疼gas费。」

「还有，如果看到unlimited的授权，要特别小心，除非是你完全信任的项目。」

我一边听一边操作，开始撤销那些可疑的授权。每次撤销都需要支付一定的gas费，虽然不多，但累计起来也是一笔开销。

「有没有更高效的方法？」我问道。

「有一些工具支持批量撤销，但要小心，确保工具本身是安全的。」艾丽丝又打开了几个不同的授权管理网站，「DeBank也有类似功能，Unrekt.net也可以，但记住我们之前说的原则：多工具验证，不要只依赖一个。」

我注意到在教学过程中，艾丽丝偶尔会直视我的眼睛，不再总是盯着屏幕。当我理解了某个概念后，她眼中会闪过一丝满意的神情。

「除了定期检查，还有什么预防方法吗？」我继续问。

「最重要的是提高操作时的警觉性。」她在纸上写下几个要点，「每次连接钱包时，仔细阅读授权内容。如果看到除了你想要的操作外，还有其他权限请求，要立刻拒绝。」

「还有，」她补充，「有些钱包会在授权时给出警告，比如MetaMask会提示『这个网站请求访问所有代币』，看到这种提示要格外小心。」

我们花了将近两个小时清理我的钱包授权。最终撤销了6个可疑授权，保留了4个我确实在使用的合法授权。

「现在安全多了。」艾丽丝合上笔记本，「但这只是开始。你需要养成定期检查的习惯。」

我看着桌上密密麻麻的笔记，心里涌起一种复杂的感情。之前的自信一扫而空，取而代之的是对自己无知的清醒认识。

「艾丽丝，」我犹豫了一下，「谢谢你总是这么耐心地教我。我知道我还有很多不懂的地方。」

她停下收拾东西的动作，看了我一眼。这次她的眼神不再冷淡，而是带着一种我说不清的温和。

「每个人都是从不懂开始的。」她轻声说，「重要的是愿意学习，愿意承认自己的不足。」

这是她第一次这样鼓励我，让我感到一阵暖流。

回到宿舍后，我主动提出帮小李也检查一下钱包授权。结果发现他的情况比我还严重，有二十多个授权，其中大部分都是不必要的。

「天哪，我的钱包这么危险？」小李看着满屏的授权记录，脸色发白。

我把从艾丽丝那里学到的知识教给了他，帮他清理了所有可疑授权。看着小李感激的表情，我第一次体验到了「保护别人」的感觉。

也许这就是艾丽丝一直在做的事情：用自己的知识保护更多的人。

第二天，我给艾丽丝发了条消息：「我帮小李也检查了钱包，发现了很多问题。」

她回复得很快：「做得不错。但记住，这些还只是表面的风险。」

我盯着手机屏幕，她的话音容上还有很多东西没有说完。「更深层的威胁」是什么？我想问，但又觉得现在问还太早。

窗外开始飘起小雨，雨点敲击着玻璃，发出细碎的声音。我把手机放在桌上，翻开她给我的那本笔记。纸页在雨声中显得格外安静。

小李在旁边整理着被子，偶尔看向我这边。他不知道，这些看似简单的钱包检查背后，其实藏着我与艾丽丝之间说不清道不明的联系。

我重新打开revoke.cash，输入钱包地址。屏幕上的授权列表干干净净，就像被仔细擦拭过的镜子。但我知道，这只是开始。

雨声渐渐大了起来。 